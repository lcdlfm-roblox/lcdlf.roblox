<script>
    // TU URL ACTUALIZADA
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzKr7kLvVgSJMeJcOJeY5kmsGYBet5q6bP0MEuvyuJObDXAWB2xWUilej31XjW3CkZV/exec';

    document.getElementById('reg').addEventListener('submit', async (e) => {
        e.preventDefault();
        const b = document.getElementById('b');
        b.innerText = "Enviando registro...";
        b.disabled = true;

        const fd = new FormData(e.target);
        
        try {
            // Usamos mode: 'no-cors' para evitar bloqueos de seguridad de Google
            await fetch(scriptURL, { method: 'POST', body: fd, mode: 'no-cors' });
            
            // Como usamos no-cors, no podemos leer la respuesta, así que avisamos al usuario
            document.getElementById('c').innerHTML = `
                <h2 style="color: #22c55e;">¡REGISTRO ENVIADO!</h2>
                <p>Tu información se ha mandado al Staff.</p>
                <p style="font-weight:bold; color:var(--naranja);">Revisa el Excel en unos segundos.</p>
                <button onclick="location.href='index.html'">Volver al Inicio</button>
            `;
        } catch (e) { 
            alert("Error al conectar con el servidor."); 
            b.innerText = "Enviar Registro";
            b.disabled = false;
        }
    });
</script>
