<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCDLF | Consulta</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --rosa: #ec4899; --naranja: #fbbf24; --fondo: radial-gradient(circle at top, #f472b6, #7c3aed, #020617); }
        body { margin: 0; min-height: 100vh; font-family: sans-serif; background: var(--fondo); display: flex; align-items: center; justify-content: center; color: white; }
        .card { background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(15px); padding: 40px; border-radius: 26px; max-width: 450px; width: 92%; text-align: center; box-shadow: 0 0 40px rgba(236,72,153,0.3); }
        input { width: 100%; padding: 15px; margin: 20px 0; border-radius: 12px; border: 1px solid rgba(255,255,255,0.2); background: #000; color: white; text-align: center; font-size: 1.2rem; }
        button { width: 100%; padding: 16px; border-radius: 12px; border: none; font-weight: bold; background: linear-gradient(135deg, var(--rosa), #8b5cf6); color: white; cursor: pointer; text-transform: uppercase; }
        .success-box { background: rgba(34, 197, 94, 0.15); border: 1px dashed #22c55e; padding: 20px; border-radius: 15px; margin-top: 20px; }
        .discord-msg { font-size: 0.85rem; color: var(--naranja); margin-top: 15px; font-weight: bold; }

        /* ESTILO DEL PDF */
        #pdf-template { width: 550px; height: 750px; background: #000; color: #fff; position: relative; border: 10px double #333; }
        .pdf-header { background: var(--rosa); padding: 20px; font-size: 24px; font-weight: bold; text-align: center; }
        .pdf-content { padding: 40px; }
        .label { color: var(--naranja); font-size: 12px; margin-top: 20px; text-transform: uppercase; }
        .value { font-size: 26px; border-bottom: 1px solid #333; margin-bottom: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h1>Verificar Selecci√≥n</h1>
    <input type="text" id="inputFolio" placeholder="TU FOLIO">
    <button onclick="buscar()">Verificar</button>
    <div id="resultado"></div>
</div>

<div style="display: none;">
    <div id="pdf-template">
        <div class="pdf-header">PASAPORTE OFICIAL: LCDLF</div>
        <div class="pdf-content">
            <div class="label">Nombre del Habitante</div>
            <div id="pdfNombre" class="value"></div>
            <div class="label">Correo Registrado</div>
            <div id="pdfCorreo" class="value" style="font-size: 18px;"></div>
            <div class="label">Folio de Identidad</div>
            <div id="pdfFolio" class="value" style="color: var(--rosa); border: none; font-size: 40px;"></div>
            <p style="margin-top: 50px; font-size: 14px;">Pr√≥ximamente recibir√°s en tu correo los enlaces de Discord y la informaci√≥n de la gala.</p>
        </div>
    </div>
</div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwD0ZPDmWuJbPYoAhYL4JRWi2407SeN_eCq84AWCvVQjg1gId32pK-WBXjznAuCTQ3n/exec';
    let userData = {};

    async function buscar() {
        const f = document.getElementById('inputFolio').value.trim();
        if(!f) return;
        document.getElementById('resultado').innerHTML = "Buscando...";
        try {
            const resp = await fetch(scriptURL + "?folio=" + f);
            const data = await resp.text();
            if (data.includes("SELECCIONADO")) {
                const parts = data.split("|");
                userData = { nombre: parts[1], correo: parts[2], folio: f };
                document.getElementById('resultado').innerHTML = `
                    <div class="success-box">
                        <p>‚ú® ¬°FELICIDADES ${userData.nombre}!</p>
                        <button onclick="descargar()">üì• DESCARGAR MI PASE</button>
                        <p class="discord-msg">‚ö†Ô∏è Pr√≥ximamente recibir√°s los links de Discord y toda la informaci√≥n en tu correo.</p>
                    </div>`;
            } else { document.getElementById('resultado').innerHTML = "<p>No seleccionado.</p>"; }
        } catch { document.getElementById('resultado').innerHTML = "<p>Error.</p>"; }
    }

    function descargar() {
        document.getElementById('pdfNombre').innerText = userData.nombre;
        document.getElementById('pdfCorreo').innerText = userData.correo;
        document.getElementById('pdfFolio').innerText = userData.folio;
        html2pdf().from(document.getElementById('pdf-template')).save();
    }
</script>
</body>
</html>
